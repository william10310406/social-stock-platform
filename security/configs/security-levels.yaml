# è³‡å®‰ç·Šæ€¥ç¨‹åº¦åˆ†å±¤ç´šé…ç½®
# æŒ‰ç…§æ”»æ“Šå°ç¶²ç«™çš„ç·Šæ€¥ç¨‹åº¦åˆ†å±¤

security_levels:
  critical:
    name: "æ¥µé«˜å±éšªç­‰ç´š"
    description: "ç«‹å³ç³»çµ±å´©æ½°é¢¨éšª - å¯èƒ½å°è‡´æ•´å€‹ç³»çµ±è¢«æ”»ç ´"
    risk_level: "ğŸš¨ CRITICAL"
    priority: 4  # æœ€é«˜å„ªå…ˆç´š
    threats:
      - "é ç¨‹ä»£ç¢¼åŸ·è¡Œ (RCE)"
      - "SQL æ³¨å…¥æ”»æ“Š"
      - "èªè­‰ç³»çµ±ç¹é"
      - "æ¬Šé™æå‡æ”»æ“Š"
      - "ç³»çµ±å¾Œé–€æ¤å…¥"
    modules:
      - "sql_injection_protection"
      - "rce_prevention"
      - "auth_bypass_protection"
      - "privilege_escalation_guard"

  high:
    name: "é«˜å±éšªç­‰ç´š"
    description: "æ•¸æ“šæ´©éœ²é¢¨éšª - å¯èƒ½å°è‡´ç”¨æˆ¶æ•¸æ“šè¢«ç«Šå–"
    risk_level: "âš ï¸ HIGH"
    priority: 3
    threats:
      - "è·¨ç«™è…³æœ¬æ”»æ“Š (XSS)"
      - "æœªæˆæ¬Šæ•¸æ“šå­˜å–"
      - "æ•æ„Ÿä¿¡æ¯æš´éœ²"
      - "ç”¨æˆ¶æ•¸æ“šæ´©éœ²"
      - "æœƒè©±åŠ«æŒ"
    modules:
      - "xss_protection"
      - "data_access_control"
      - "sensitive_data_masking"
      - "session_hijack_prevention"

  medium:
    name: "ä¸­å±éšªç­‰ç´š"
    description: "åŠŸèƒ½å½±éŸ¿é¢¨éšª - å¯èƒ½å½±éŸ¿ç¶²ç«™æ­£å¸¸åŠŸèƒ½"
    risk_level: "ğŸ”¶ MEDIUM"
    priority: 2
    threats:
      - "è·¨ç«™è«‹æ±‚å½é€  (CSRF)"
      - "è¼¸å…¥é©—è­‰ç¹é"
      - "æ¥­å‹™é‚è¼¯ç¼ºé™·"
      - "æª”æ¡ˆä¸Šå‚³æ¼æ´"
      - "API æ¿«ç”¨"
    modules:
      - "csrf_protection"
      - "input_validation"
      - "business_logic_guard"
      - "file_upload_security"
      - "api_rate_limiting"

  low:
    name: "ä½å±éšªç­‰ç´š"
    description: "ä¸€èˆ¬å®‰å…¨é¢¨éšª - è¼•å¾®çš„å®‰å…¨å•é¡Œ"
    risk_level: "ğŸ”µ LOW"
    priority: 1
    threats:
      - "ä¿¡æ¯æ´©éœ²"
      - "å¼±å¯†ç¢¼ç­–ç•¥"
      - "HTTP å®‰å…¨æ¨™é ­ç¼ºå¤±"
      - "ç›®éŒ„éæ­·"
      - "æ•æ„Ÿè·¯å¾‘æš´éœ²"
    modules:
      - "info_disclosure_prevention"
      - "password_policy"
      - "security_headers"
      - "path_traversal_guard"
      - "endpoint_security"
  info_0:
    name: "åŸºç¤å…ƒä»¶å±¤ç´š"
    description: "æœ€åŸºç¤å…ƒä»¶ - å¸¸æ•¸ã€å·¥å…·ã€ä¾‹å¤–è™•ç†"
    risk_level: "â„¹ï¸ INFO-0"
    priority: 0.1  # æœ€ä½å„ªå…ˆç´šï¼Œç´”åŸºç¤å…ƒä»¶
    components:
      - "å®‰å…¨å¸¸æ•¸å®šç¾©"
      - "å·¥å…·å‡½æ•¸"
      - "ä¾‹å¤–è™•ç†"
    modules:
      - "security_constants"
      - "security_utils"
      - "security_exceptions"
    dependencies: []  # ç„¡ä¾è³´
  
  info_1:
    name: "åŸºç¤æœå‹™å±¤ç´š"
    description: "æ—¥èªŒå’Œé…ç½®ç®¡ç†æœå‹™ - åªä¾è³´åŸºç¤å…ƒä»¶"
    risk_level: "â„¹ï¸ INFO-1"
    priority: 0.2
    components:
      - "æ—¥èªŒç³»çµ±"
      - "é…ç½®ç®¡ç†"
    modules:
      - "security_logger"
      - "config_manager"
    dependencies:
      - "info_0"  # åªä¾è³´åŸºç¤å…ƒä»¶
  
  info_2:
    name: "ç³»çµ±ç›£æ§å±¤ç´š"
    description: "ç›£æ§å’Œé…ç½®æœå‹™ - ä¾è³´åŸºç¤å…ƒä»¶å’Œæ—¥èªŒæœå‹™"
    risk_level: "â„¹ï¸ INFO-2"
    priority: 0.3
    components:
      - "ç³»çµ±ç›£æ§"
      - "é…ç½®ç®¡ç†"
    modules:
      - "security_monitoring"
      - "config_manager"
    dependencies:
      - "info_0"  # ä¾è³´åŸºç¤å…ƒä»¶
      - "info_1"  # ä¾è³´æ—¥èªŒæœå‹™

# XSS é˜²è­·é…ç½® (å±¬æ–¼ HIGH ç­‰ç´š)
xss_protection_config:
  level: "high"
  strict_mode: true
  allowed_tags:
    - "b"
    - "i" 
    - "em"
    - "strong"
    - "p"
    - "br"
    - "ul"
    - "ol"
    - "li"
  blocked_attributes:
    - "onclick"
    - "onload"
    - "onerror"
    - "onmouseover"
    - "onfocus"
    - "onblur"
    - "onchange"
    - "onsubmit"
  blocked_protocols:
    - "javascript:"
    - "data:"
    - "vbscript:"
  content_security_policy:
    default_src: "'self'"
    script_src: "'self'"
    style_src: "'self' 'unsafe-inline'"
    img_src: "'self' data: https:"
    font_src: "'self' https://fonts.gstatic.com"
    connect_src: "'self'"
    object_src: "'none'"
    base_uri: "'self'"
    form_action: "'self'"

# ä¾è³´é—œä¿‚è¦å‰‡ (ç°¡åŒ–)
dependency_rules:
  # åŸºæœ¬è¦å‰‡ï¼šé«˜å„ªå…ˆç´šå¯ä»¥å¼•ç”¨ä½å„ªå…ˆç´š
  rule: "higher_priority_can_import_lower_priority"
  
  # ç¦æ­¢å‘ä¸Šå¼•ç”¨ï¼šä½å„ªå…ˆç´šä¸èƒ½å¼•ç”¨é«˜å„ªå…ˆç´š
  forbidden_upward_imports: true
  
  # ç¦æ­¢å¾ªç’°ä¾è³´
  forbidden_circular_imports: true
  
  # å„ªå…ˆç´šé †åº (æ•¸å­—è¶Šå¤§å„ªå…ˆç´šè¶Šé«˜)
  priority_order:
    info_0: 0    # åŸºç¤å…ƒä»¶å±¤ç´šï¼ˆconstants, utils, exceptionsï¼‰
    info_1: 1    # åŸºç¤æœå‹™å±¤ç´šï¼ˆlogger, config_managerï¼‰
    info_2: 2    # ç³»çµ±ç›£æ§å±¤ç´šï¼ˆmonitoringï¼‰
    low: 1       # ä¸€èˆ¬å®‰å…¨é¢¨éšª
    medium: 2    # åŠŸèƒ½å½±éŸ¿é¢¨éšª
    high: 3      # æ•¸æ“šæ´©éœ²é¢¨éšª
    critical: 4  # æœ€é«˜å„ªå…ˆç´šï¼Œç³»çµ±å´©æ½°é¢¨éšª

# å®‰å…¨äº‹ä»¶éŸ¿æ‡‰ç­‰ç´š
incident_response:
  critical:
    response_time: "ç«‹å³ (0-15åˆ†é˜)"
    actions:
      - "è‡ªå‹•é˜»æ–·æ”»æ“Šä¾†æº"
      - "ç«‹å³é€šçŸ¥ç³»çµ±ç®¡ç†å“¡"
      - "å•Ÿå‹•ç·Šæ€¥ä¿®å¾©ç¨‹åº"
      - "è¨˜éŒ„è©³ç´°æ”»æ“Šä¿¡æ¯"
  
  high:
    response_time: "ç·Šæ€¥ (15åˆ†é˜-1å°æ™‚)"
    actions:
      - "å¢å¼·ç›£æ§"
      - "é€šçŸ¥å®‰å…¨åœ˜éšŠ"
      - "åˆ†ææ”»æ“Šæ¨¡å¼"
      - "æ›´æ–°é˜²è­·è¦å‰‡"
  
  medium:
    response_time: "é‡è¦ (1-4å°æ™‚)"
    actions:
      - "è¨˜éŒ„å®‰å…¨äº‹ä»¶"
      - "å®šæœŸæª¢æŸ¥"
      - "å„ªåŒ–é˜²è­·ç­–ç•¥"
  
  low:
    response_time: "ä¸€èˆ¬ (4-24å°æ™‚)"
    actions:
      - "æ—¥èªŒè¨˜éŒ„"
      - "å®šæœŸå ±å‘Š"
